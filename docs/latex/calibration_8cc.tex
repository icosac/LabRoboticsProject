\hypertarget{calibration_8cc}{}\section{src/calibration.cc File Reference}
\label{calibration_8cc}\index{src/calibration.\+cc@{src/calibration.\+cc}}
{\ttfamily \#include \char`\"{}calibration.\+hh\char`\"{}}\newline
Include dependency graph for calibration.\+cc\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{calibration_8cc__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{calibration_8cc_aac72e7c87050ab15c4158b416e933e96}{calibration}} (const string input\+File)
\begin{DoxyCompactList}\small\item\em Function to run the complete calibration. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{calibration_8cc_a1ee80d81c5b660c3cbe85a0c97da3e35}{read}} (const File\+Node \&node, \mbox{\hyperlink{class_settings}{Settings}} \&x, const \mbox{\hyperlink{class_settings}{Settings}} \&default\+\_\+value)
\begin{DoxyCompactList}\small\item\em Reads settings from file. If there is none then initiate a new {\ttfamily \mbox{\hyperlink{class_settings}{Settings}}}. \end{DoxyCompactList}\item 
static double \mbox{\hyperlink{calibration_8cc_a595849a1b81e38ffd3e1f7f70f88085e}{compute\+Reprojection\+Errors}} (const vector$<$ vector$<$ Point3f $>$ $>$ \&object\+Points, const vector$<$ vector$<$ Point2f $>$ $>$ \&image\+Points, const vector$<$ Mat $>$ \&rvecs, const vector$<$ Mat $>$ \&tvecs, const Mat \&camera\+Matrix, const Mat \&dist\+Coeffs, vector$<$ float $>$ \&per\+View\+Errors, bool fisheye)
\begin{DoxyCompactList}\small\item\em Compute the errors of the projection. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{calibration_8cc_a9deaf00ea7081c5e9ce50a64c9946fa9}{calc\+Board\+Corner\+Positions}} (Size board\+Size, float square\+Size, vector$<$ Point3f $>$ \&corners)
\begin{DoxyCompactList}\small\item\em This function compute the position of the upper corners of every cell. \end{DoxyCompactList}\item 
static bool \mbox{\hyperlink{calibration_8cc_a7ee968c34a2834af6e2064abfc0e8a33}{run\+Calibration}} (\mbox{\hyperlink{class_settings}{Settings}} \&s, Size \&image\+Size, Mat \&camera\+Matrix, Mat \&dist\+Coeffs, vector$<$ vector$<$ Point2f $>$ $>$ image\+Points, vector$<$ Mat $>$ \&rvecs, vector$<$ Mat $>$ \&tvecs, vector$<$ float $>$ \&reproj\+Errs, double \&total\+Avg\+Err)
\begin{DoxyCompactList}\small\item\em This function run the calibration creating the matrixed for the camera and the distorsion coefficients. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{calibration_8cc_ad4fc2fb73a45905ac2e646f371a79cee}{save\+Camera\+Params}} (const \mbox{\hyperlink{class_settings}{Settings}} \&s, const Size \&image\+Size, const Mat \&camera\+Matrix, const Mat \&dist\+Coeffs, const vector$<$ Mat $>$ \&rvecs, const vector$<$ Mat $>$ \&tvecs, const vector$<$ float $>$ \&reproj\+Errs, const vector$<$ vector$<$ Point2f $>$ $>$ \&image\+Points, const double total\+Avg\+Err)
\begin{DoxyCompactList}\small\item\em Function to save the computed parameters to a file. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{calibration_8cc_ac7558c8da6af683fc1c86c2ede7bb31c}{run\+Calibration\+And\+Save}} (\mbox{\hyperlink{class_settings}{Settings}} \&s, Size image\+Size, Mat \&camera\+Matrix, Mat \&dist\+Coeffs, vector$<$ vector$<$ Point2f $>$ $>$ image\+Points)
\begin{DoxyCompactList}\small\item\em Reads settings from file. If there is none then initiate a new {\ttfamily \mbox{\hyperlink{class_settings}{Settings}}}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{calibration_8cc_a9deaf00ea7081c5e9ce50a64c9946fa9}\label{calibration_8cc_a9deaf00ea7081c5e9ce50a64c9946fa9}} 
\index{calibration.\+cc@{calibration.\+cc}!calc\+Board\+Corner\+Positions@{calc\+Board\+Corner\+Positions}}
\index{calc\+Board\+Corner\+Positions@{calc\+Board\+Corner\+Positions}!calibration.\+cc@{calibration.\+cc}}
\subsubsection{\texorpdfstring{calc\+Board\+Corner\+Positions()}{calcBoardCornerPositions()}}
{\footnotesize\ttfamily void calc\+Board\+Corner\+Positions (\begin{DoxyParamCaption}\item[{Size}]{board\+Size,  }\item[{float}]{square\+Size,  }\item[{vector$<$ Point3f $>$ \&}]{corners }\end{DoxyParamCaption})}



This function compute the position of the upper corners of every cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em board\+Siz} & The dimension of the chess board. \\
\hline
\mbox{\tt in}  & {\em square\+Size} & The dimension of the edge of a cell. \\
\hline
\mbox{\tt out}  & {\em corners} & A vector of Point3fs which equals to the corners of the cells. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{calibration_8cc_aac72e7c87050ab15c4158b416e933e96}\label{calibration_8cc_aac72e7c87050ab15c4158b416e933e96}} 
\index{calibration.\+cc@{calibration.\+cc}!calibration@{calibration}}
\index{calibration@{calibration}!calibration.\+cc@{calibration.\+cc}}
\subsubsection{\texorpdfstring{calibration()}{calibration()}}
{\footnotesize\ttfamily int calibration (\begin{DoxyParamCaption}\item[{const string}]{input\+File }\end{DoxyParamCaption})}



Function to run the complete calibration. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em input\+File} & Name of the setting.\+xml file. It\textquotesingle{}s set to default to default.\+xml\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/2 if the settings file could be load but the input was not well-\/formed~\newline
 -\/1 if the settings file could not be opened.~\newline
 0 if everything went fine. 
\end{DoxyReturn}
\mbox{\Hypertarget{calibration_8cc_a595849a1b81e38ffd3e1f7f70f88085e}\label{calibration_8cc_a595849a1b81e38ffd3e1f7f70f88085e}} 
\index{calibration.\+cc@{calibration.\+cc}!compute\+Reprojection\+Errors@{compute\+Reprojection\+Errors}}
\index{compute\+Reprojection\+Errors@{compute\+Reprojection\+Errors}!calibration.\+cc@{calibration.\+cc}}
\subsubsection{\texorpdfstring{compute\+Reprojection\+Errors()}{computeReprojectionErrors()}}
{\footnotesize\ttfamily static double compute\+Reprojection\+Errors (\begin{DoxyParamCaption}\item[{const vector$<$ vector$<$ Point3f $>$ $>$ \&}]{object\+Points,  }\item[{const vector$<$ vector$<$ Point2f $>$ $>$ \&}]{image\+Points,  }\item[{const vector$<$ Mat $>$ \&}]{rvecs,  }\item[{const vector$<$ Mat $>$ \&}]{tvecs,  }\item[{const Mat \&}]{camera\+Matrix,  }\item[{const Mat \&}]{dist\+Coeffs,  }\item[{vector$<$ float $>$ \&}]{per\+View\+Errors,  }\item[{bool}]{fisheye }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Compute the errors of the projection. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em object\+Points} & The real image points which will be projected \\
\hline
\mbox{\tt in}  & {\em rvecs} & Input vector of rotation vectors estimated for each pattern view. \\
\hline
\mbox{\tt in}  & {\em tvecs} & Input vector of translation vectors estimated for each pattern view. \\
\hline
\mbox{\tt in}  & {\em camera\+Matrix} & The matrix containing the parameters for the camera \\
\hline
\mbox{\tt in}  & {\em dist\+Coeffs} & The matrix containing the distortion coefficients. \\
\hline
\mbox{\tt in}  & {\em fisheye} & A variable which says if a fish eye correction should be applied or no. \\
\hline
\mbox{\tt out}  & {\em per\+View\+Errors} & A vector containing the error for each image. \\
\hline
\mbox{\tt out}  & {\em image\+Points} & The projected points for each image.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total error. 
\end{DoxyReturn}
\mbox{\Hypertarget{calibration_8cc_a1ee80d81c5b660c3cbe85a0c97da3e35}\label{calibration_8cc_a1ee80d81c5b660c3cbe85a0c97da3e35}} 
\index{calibration.\+cc@{calibration.\+cc}!read@{read}}
\index{read@{read}!calibration.\+cc@{calibration.\+cc}}
\subsubsection{\texorpdfstring{read()}{read()}}
{\footnotesize\ttfamily static void read (\begin{DoxyParamCaption}\item[{const File\+Node \&}]{node,  }\item[{\mbox{\hyperlink{class_settings}{Settings}} \&}]{x,  }\item[{const \mbox{\hyperlink{class_settings}{Settings}} \&}]{default\+\_\+value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Reads settings from file. If there is none then initiate a new {\ttfamily \mbox{\hyperlink{class_settings}{Settings}}}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em node} & node to consider for getting settings; \\
\hline
\mbox{\tt in}  & {\em x} & {\ttfamily \mbox{\hyperlink{class_settings}{Settings}}} to configure; \\
\hline
\mbox{\tt in}  & {\em default\+\_\+value} & {\ttfamily \mbox{\hyperlink{class_settings}{Settings}}} default value. Setted to {\ttfamily \mbox{\hyperlink{class_settings}{Settings()}}}. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{calibration_8cc_a7ee968c34a2834af6e2064abfc0e8a33}\label{calibration_8cc_a7ee968c34a2834af6e2064abfc0e8a33}} 
\index{calibration.\+cc@{calibration.\+cc}!run\+Calibration@{run\+Calibration}}
\index{run\+Calibration@{run\+Calibration}!calibration.\+cc@{calibration.\+cc}}
\subsubsection{\texorpdfstring{run\+Calibration()}{runCalibration()}}
{\footnotesize\ttfamily static bool run\+Calibration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_settings}{Settings}} \&}]{s,  }\item[{Size \&}]{image\+Size,  }\item[{Mat \&}]{camera\+Matrix,  }\item[{Mat \&}]{dist\+Coeffs,  }\item[{vector$<$ vector$<$ Point2f $>$ $>$}]{image\+Points,  }\item[{vector$<$ Mat $>$ \&}]{rvecs,  }\item[{vector$<$ Mat $>$ \&}]{tvecs,  }\item[{vector$<$ float $>$ \&}]{reproj\+Errs,  }\item[{double \&}]{total\+Avg\+Err }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



This function run the calibration creating the matrixed for the camera and the distorsion coefficients. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & The {\ttfamily \mbox{\hyperlink{class_settings}{Settings}}} read from the file and memorized. \\
\hline
\mbox{\tt in}  & {\em image\+Size} & The size of the image used in {\ttfamily calibrate\+Camera()} to initialize the camera matrix. \\
\hline
\mbox{\tt in}  & {\em image\+Points} & The projected points for each image. \\
\hline
\mbox{\tt in}  & {\em reproj\+Errs} & The re-\/projection error, that is a geometric error corresponding to the image distance between a projected point and a measured one. \\
\hline
\mbox{\tt out}  & {\em camera\+Matrix} & The matrix of the camera parameters \\
\hline
\mbox{\tt out}  & {\em dist\+Coeffs} & The matrix of the distorsion coefficients. \\
\hline
\mbox{\tt out}  & {\em rvecs} & Output vector of rotation vectors estimated for each pattern view. \\
\hline
\mbox{\tt out}  & {\em tvecs} & Output vector of translation vectors estimated for each pattern view. \\
\hline
\mbox{\tt out}  & {\em total\+Avg\+Err} & The total avarage error given from distorsion.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily false} if one or more elements in the {\ttfamily camera\+Matrix} and {\ttfamily dist\+Coeffs} are invalid.~\newline
 {\ttfamily true} if all the elements are valid. 
\end{DoxyReturn}
\mbox{\Hypertarget{calibration_8cc_ac7558c8da6af683fc1c86c2ede7bb31c}\label{calibration_8cc_ac7558c8da6af683fc1c86c2ede7bb31c}} 
\index{calibration.\+cc@{calibration.\+cc}!run\+Calibration\+And\+Save@{run\+Calibration\+And\+Save}}
\index{run\+Calibration\+And\+Save@{run\+Calibration\+And\+Save}!calibration.\+cc@{calibration.\+cc}}
\subsubsection{\texorpdfstring{run\+Calibration\+And\+Save()}{runCalibrationAndSave()}}
{\footnotesize\ttfamily bool run\+Calibration\+And\+Save (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_settings}{Settings}} \&}]{s,  }\item[{Size}]{image\+Size,  }\item[{Mat \&}]{camera\+Matrix,  }\item[{Mat \&}]{dist\+Coeffs,  }\item[{vector$<$ vector$<$ Point2f $>$ $>$}]{image\+Points }\end{DoxyParamCaption})}



Reads settings from file. If there is none then initiate a new {\ttfamily \mbox{\hyperlink{class_settings}{Settings}}}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & The {\ttfamily \mbox{\hyperlink{class_settings}{Settings}}} being used during the execution. \\
\hline
\mbox{\tt in}  & {\em image\+Size} & The dimensions of the images. \\
\hline
\mbox{\tt in}  & {\em image\+Points} & The projected points for each image. \\
\hline
\mbox{\tt out}  & {\em camera\+Matrix} & The matrix which is used to store the values for the camera parameters. \\
\hline
\mbox{\tt out}  & {\em dist\+Coeffs} & The matrix which is used to store the distortion coefficients.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily true} if the calibration succeded.~\newline
 {\ttfamily false} otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{calibration_8cc_ad4fc2fb73a45905ac2e646f371a79cee}\label{calibration_8cc_ad4fc2fb73a45905ac2e646f371a79cee}} 
\index{calibration.\+cc@{calibration.\+cc}!save\+Camera\+Params@{save\+Camera\+Params}}
\index{save\+Camera\+Params@{save\+Camera\+Params}!calibration.\+cc@{calibration.\+cc}}
\subsubsection{\texorpdfstring{save\+Camera\+Params()}{saveCameraParams()}}
{\footnotesize\ttfamily static void save\+Camera\+Params (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_settings}{Settings}} \&}]{s,  }\item[{const Size \&}]{image\+Size,  }\item[{const Mat \&}]{camera\+Matrix,  }\item[{const Mat \&}]{dist\+Coeffs,  }\item[{const vector$<$ Mat $>$ \&}]{rvecs,  }\item[{const vector$<$ Mat $>$ \&}]{tvecs,  }\item[{const vector$<$ float $>$ \&}]{reproj\+Errs,  }\item[{const vector$<$ vector$<$ Point2f $>$ $>$ \&}]{image\+Points,  }\item[{const double}]{total\+Avg\+Err }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Function to save the computed parameters to a file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em s} & Use the {\ttfamily \mbox{\hyperlink{class_settings}{Settings}}} got at the beginning for information as the output file name, image and board size. \\
\hline
\mbox{\tt in}  & {\em image\+Size} & The size of the imgage. \\
\hline
\mbox{\tt in}  & {\em camera\+Matrix} & The camera matrix. \\
\hline
\mbox{\tt in}  & {\em dist\+Coeffs} & The distorsion coefficient matrix. \\
\hline
 & {\em \mbox{[}int\mbox{]}} & rvecs Vector of rotation vectors estimated for each pattern view. \\
\hline
\mbox{\tt in}  & {\em tvecs} & Vector of translation vectors estimated for each pattern view. \\
\hline
\mbox{\tt in}  & {\em reproj\+Errs} & The re-\/projection error, that is a geometric error corresponding to the image distance between a projected point and a measured one. \\
\hline
\mbox{\tt in}  & {\em image\+Points} & The projected points for each image. \\
\hline
\mbox{\tt in}  & {\em total\+Avg\+Err} & The total avarage error given from distorsion. \\
\hline
\end{DoxyParams}
Open file for writing

Stores time of calibration

Store infos about the images 