<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LabRoboticsProject: src/unwrapping.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LabRoboticsProject
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">unwrapping.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="unwrapping_8hh_source.html">unwrapping.hh</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for unwrapping.cc:</div>
<div class="dyncontent">
<div class="center"><img src="unwrapping_8cc__incl.png" border="0" usemap="#src_2unwrapping_8cc" alt=""/></div>
<map name="src_2unwrapping_8cc" id="src_2unwrapping_8cc">
<area shape="rect"  title=" " alt="" coords="1401,5,1530,31"/>
<area shape="rect"  href="unwrapping_8hh.html" title=" " alt="" coords="1411,79,1520,104"/>
<area shape="rect"  href="utils_8hh.html" title=" " alt="" coords="1441,445,1504,471"/>
<area shape="rect"  title=" " alt="" coords="251,519,323,544"/>
<area shape="rect"  title=" " alt="" coords="1654,519,1798,544"/>
<area shape="rect"  title=" " alt="" coords="1822,519,1949,544"/>
<area shape="rect"  title=" " alt="" coords="918,519,1061,544"/>
<area shape="rect"  title=" " alt="" coords="1974,519,2139,544"/>
<area shape="rect"  href="settings_8hh.html" title=" " alt="" coords="610,299,695,324"/>
<area shape="rect"  title=" " alt="" coords="62,445,120,471"/>
<area shape="rect"  title=" " alt="" coords="660,445,714,471"/>
<area shape="rect"  href="detection_8hh.html" title=" " alt="" coords="1419,152,1513,177"/>
<area shape="rect"  title=" " alt="" coords="1833,225,1899,251"/>
<area shape="rect"  title=" " alt="" coords="2126,152,2270,177"/>
<area shape="rect"  title=" " alt="" coords="347,519,416,544"/>
<area shape="rect"  title=" " alt="" coords="1465,519,1544,544"/>
<area shape="rect"  title=" " alt="" coords="1568,519,1630,544"/>
<area shape="rect"  title=" " alt="" coords="1085,519,1276,544"/>
<area shape="rect"  title=" " alt="" coords="1300,519,1357,544"/>
<area shape="rect"  title=" " alt="" coords="1381,519,1441,544"/>
<area shape="rect"  href="filter_8hh.html" title=" " alt="" coords="1323,372,1387,397"/>
<area shape="rect"  href="maths_8hh.html" title=" " alt="" coords="297,372,373,397"/>
<area shape="rect"  title=" " alt="" coords="397,372,554,397"/>
<area shape="rect"  title=" " alt="" coords="578,372,644,397"/>
<area shape="rect"  title=" " alt="" coords="741,445,799,471"/>
<area shape="rect"  title=" " alt="" coords="473,445,538,471"/>
<area shape="rect"  title=" " alt="" coords="397,445,449,471"/>
<area shape="rect"  href="configure_8hh.html" title=" " alt="" coords="1292,225,1386,251"/>
<area shape="rect"  title=" " alt="" coords="1580,225,1656,251"/>
<area shape="rect"  title=" " alt="" coords="972,225,1024,251"/>
<area shape="rect"  title=" " alt="" coords="973,299,1122,324"/>
<area shape="rect"  title=" " alt="" coords="1145,299,1301,324"/>
<area shape="rect"  href="camera__capture_8hh.html" title=" " alt="" coords="1019,372,1155,397"/>
<area shape="rect"  title=" " alt="" coords="989,445,1049,471"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3c7ffff21a9a31fea3e9777b02d09291"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unwrapping_8cc.html#a3c7ffff21a9a31fea3e9777b02d09291">AREA_RATIO</a>&#160;&#160;&#160;0.7</td></tr>
<tr class="separator:a3c7ffff21a9a31fea3e9777b02d09291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2f75959ffa14bc8fd8d0491e890c122"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unwrapping_8cc.html#ac2f75959ffa14bc8fd8d0491e890c122">AREA_MIN</a>&#160;&#160;&#160;500</td></tr>
<tr class="separator:ac2f75959ffa14bc8fd8d0491e890c122"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abf82b59ef33c7549580276e00ae85d18"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unwrapping_8cc.html#abf82b59ef33c7549580276e00ae85d18">distance</a> (Point c1, Point c2)</td></tr>
<tr class="memdesc:abf82b59ef33c7549580276e00ae85d18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the euclidean distance.  <a href="#abf82b59ef33c7549580276e00ae85d18">More...</a><br /></td></tr>
<tr class="separator:abf82b59ef33c7549580276e00ae85d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac041ab9990eb25243d6e5da1e3d47e96"><td class="memItemLeft" align="right" valign="top"><a class="el" href="draw_8hh.html#aa620a13339ac3a1177c86edc549fda9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unwrapping_8cc.html#ac041ab9990eb25243d6e5da1e3d47e96">unwrapping</a> (const bool _imgRead, Mat *img)</td></tr>
<tr class="memdesc:ac041ab9990eb25243d6e5da1e3d47e96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take some images according to a xml and unwrap the black rectangle inside the image after appling undistortion trasformation.  <a href="#ac041ab9990eb25243d6e5da1e3d47e96">More...</a><br /></td></tr>
<tr class="separator:ac041ab9990eb25243d6e5da1e3d47e96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0327df69102bf644a011c245ae7ad4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unwrapping_8cc.html#ac0327df69102bf644a011c245ae7ad4f">createPointsHigh</a> (const vector&lt; Point &gt; &amp;rectLow, vector&lt; Point &gt; &amp;rectHigh)</td></tr>
<tr class="memdesc:ac0327df69102bf644a011c245ae7ad4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given the lower rectangle's points compute and retrieve the higher rectangle's points. \deteils The matching between the vectors is guarantee: the i elements of the vectors is refered to the same x,y point (with different z). At the moment the white points are constant and not taken from the image).  <a href="#ac0327df69102bf644a011c245ae7ad4f">More...</a><br /></td></tr>
<tr class="separator:ac0327df69102bf644a011c245ae7ad4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac30b4dbae9022e84e10ef97ba156c581"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unwrapping_8cc.html#ac30b4dbae9022e84e10ef97ba156c581">find_rect</a> (vector&lt; Point &gt; &amp;_rect, const <a class="el" href="draw_8hh.html#aa620a13339ac3a1177c86edc549fda9b">int</a> &amp;width, const <a class="el" href="draw_8hh.html#aa620a13339ac3a1177c86edc549fda9b">int</a> &amp;height)</td></tr>
<tr class="memdesc:ac30b4dbae9022e84e10ef97ba156c581"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the right vertexes from a vector of points that more or less define the rectangle.  <a href="#ac30b4dbae9022e84e10ef97ba156c581">More...</a><br /></td></tr>
<tr class="separator:ac30b4dbae9022e84e10ef97ba156c581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf7df08897ed4d1a7ddcf055b18cca8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unwrapping_8cc.html#a3cf7df08897ed4d1a7ddcf055b18cca8">loadCoefficients</a> (const string filename, Mat &amp;camera_matrix, Mat &amp;dist_coeffs)</td></tr>
<tr class="memdesc:a3cf7df08897ed4d1a7ddcf055b18cca8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load coefficients from a file.  <a href="#a3cf7df08897ed4d1a7ddcf055b18cca8">More...</a><br /></td></tr>
<tr class="separator:a3cf7df08897ed4d1a7ddcf055b18cca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ac2f75959ffa14bc8fd8d0491e890c122"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2f75959ffa14bc8fd8d0491e890c122">&#9670;&nbsp;</a></span>AREA_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AREA_MIN&#160;&#160;&#160;500</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3c7ffff21a9a31fea3e9777b02d09291"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c7ffff21a9a31fea3e9777b02d09291">&#9670;&nbsp;</a></span>AREA_RATIO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AREA_RATIO&#160;&#160;&#160;0.7</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac0327df69102bf644a011c245ae7ad4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0327df69102bf644a011c245ae7ad4f">&#9670;&nbsp;</a></span>createPointsHigh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void createPointsHigh </td>
          <td>(</td>
          <td class="paramtype">const vector&lt; Point &gt; &amp;&#160;</td>
          <td class="paramname"><em>rectLow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; Point &gt; &amp;&#160;</td>
          <td class="paramname"><em>rectHigh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given the lower rectangle's points compute and retrieve the higher rectangle's points. \deteils The matching between the vectors is guarantee: the i elements of the vectors is refered to the same x,y point (with different z). At the moment the white points are constant and not taken from the image). </p>
<p>Store in the given vector the white corners in the same order as the given black ones.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rectLow</td><td>The 4 points that define the black rectangle on the floor. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rectHigh</td><td>The vector that will contain the 4 points that will define the high corner that pass through the white points. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abf82b59ef33c7549580276e00ae85d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf82b59ef33c7549580276e00ae85d18">&#9670;&nbsp;</a></span>distance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double distance </td>
          <td>(</td>
          <td class="paramtype">Point&#160;</td>
          <td class="paramname"><em>c1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Point&#160;</td>
          <td class="paramname"><em>c2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the euclidean distance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c1</td><td>The first point. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c2</td><td>The second point.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The euclidean distance. </dd></dl>

</div>
</div>
<a id="ac30b4dbae9022e84e10ef97ba156c581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac30b4dbae9022e84e10ef97ba156c581">&#9670;&nbsp;</a></span>find_rect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void find_rect </td>
          <td>(</td>
          <td class="paramtype">vector&lt; Point &gt; &amp;&#160;</td>
          <td class="paramname"><em>_rect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="draw_8hh.html#aa620a13339ac3a1177c86edc549fda9b">int</a> &amp;&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="draw_8hh.html#aa620a13339ac3a1177c86edc549fda9b">int</a> &amp;&#160;</td>
          <td class="paramname"><em>height</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the right vertexes from a vector of points that more or less define the rectangle. </p>
<p>Since the border of the arena might not always be clean but might have some imperfection, this functions computes the four vertixes taking all the points and computing the four that are the clostest to the corner of the image.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">[in/out]</td><td>_rect The vector containing the actual possible points that delimt the rectangle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">width</td><td>The width of the original image from which the points of the rectangle come from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">height</td><td>The height of the original image from which the points of the rectangle come from. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3cf7df08897ed4d1a7ddcf055b18cca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf7df08897ed4d1a7ddcf055b18cca8">&#9670;&nbsp;</a></span>loadCoefficients()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loadCoefficients </td>
          <td>(</td>
          <td class="paramtype">const string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>camera_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>dist_coeffs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load coefficients from a file. </p>
<p>Load two matrix 'camera_matrix' and 'distortion_coefficients' from the xml file passed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>The string that identify the location of the xml file. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">camera_matrix</td><td>Where the 'camera_matrix' matrix is saved. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dist_coeffs</td><td>Where the 'distortion_coefficients' matrix is saved. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac041ab9990eb25243d6e5da1e3d47e96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac041ab9990eb25243d6e5da1e3d47e96">&#9670;&nbsp;</a></span>unwrapping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="draw_8hh.html#aa620a13339ac3a1177c86edc549fda9b">int</a> unwrapping </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>_imgRead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat *&#160;</td>
          <td class="paramname"><em>img</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take some images according to a xml and unwrap the black rectangle inside the image after appling undistortion trasformation. </p>
<p>Load from the xml file 'data/settings.xml' the name of some images, load the images from the file,<br />
apply the calibration (undistortion trasformation) thanks to the matrices load with the 'loadCoefficients' function.<br />
Then, with the use of a filter for the black the region of interest (a rectangle) is identified and all the perspective is rotated for reach a top view of the rectangle.<br />
Finally, the images are saved on some files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">_imgRead</td><td>Boolean flag that says if load or not the image from file, or as a function parameter. In addition, also the return procedure change if true the image is saved on the disk otherwise is saved on the img function parameter. True=load and store on file. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">[in/out]</td><td>img The image that eventually is loaded from the function. And the one that will be modified for returning the elaborated frame. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 0 is return if the function reach the end. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
